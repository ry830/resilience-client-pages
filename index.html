<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ãƒ¬ã‚¸ãƒªã‚¨ãƒ³ã‚¹å‘ä¸Šãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°</title>
    <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Roboto:300,300italic,700,700italic">
    <link rel="stylesheet" href="//cdn.rawgit.com/necolas/normalize.css/master/normalize.css">
    <link rel="stylesheet" href="//cdn.rawgit.com/milligram/milligram/master/dist/milligram.min.css">
    
    <link rel="stylesheet" href="style.css">
    <script src="script.js"></script>
    <style>
        /* (CSS Styles are omitted for brevity, they should remain in style.css or your current file) */
        /* ... */
        .dashboard-grid {
             display: grid;
             grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
             gap: 20px;
             margin-bottom: 20px;
        }
        .dashboard-item-card {
            background-color: #ffffff;
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05);
            text-align: center;
        }
        .dashboard-item-card h4 {
            color: #5c6bc0;
            font-size: 1.2rem;
            margin-bottom: 10px;
        }
        .dashboard-value {
            font-weight: 700;
            color: #e91e63; /* Pink accent */
            font-size: 2.2rem;
            display: block;
            margin-top: 5px;
        }
        /* Lucky Meter Bar */
        .lucky-meter-container {
            background-color: #e0e0e0;
            border-radius: 5px;
            height: 25px;
            overflow: hidden;
            margin-top: 10px;
            position: relative;
        }
        .lucky-meter-fill {
            height: 100%;
            width: 0%; /* Will be updated by JS */
            background-color: #8bc34a; /* Green for good luck */
            transition: width 0.5s ease-in-out;
            position: absolute;
            top: 0;
            left: 0;
        }
        .lucky-meter-text {
            position: absolute;
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #333; /* Text color over bar */
            font-weight: bold;
            font-size: 0.9rem;
            z-index: 1; /* Ensure text is above fill */
        }
        /* Calendar Placeholder */
        .calendar-grid {
             display: grid;
             grid-template-columns: repeat(7, 1fr);
             gap: 5px;
        }
        .calendar-day {
             padding: 8px 0;
             border-radius: 5px;
             background-color: #f0f0f0;
             color: #666;
             font-size: 0.9em;
        }
        .calendar-day.today {
             background-color: #bbdefb;
             color: #3f51b5;
             font-weight: bold;
        }
        .calendar-day.has-record {
             background-color: #a5d6a7; /* Green for records */
             color: #388e3c;
             font-weight: bold;
        }
        .calendar-day.weekend {
             color: #e91e63; /* Pink for weekend */
        }
        .calendar-header {
             font-weight: bold;
             color: #333;
             padding-bottom: 5px;
             border-bottom: 1px solid #eee;
        }
        /* Menu items */
        .menu {
             display: grid;
             grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
             gap: 20px;
             margin-top: 30px;
        }
        .menu-item {
             display: flex;
             align-items: center;
             padding: 20px;
             border-radius: 8px;
             text-decoration: none;
             color: #ffffff;
             font-weight: 600;
             font-size: 1.2rem;
             box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
             transition: transform 0.2s ease-in-out, box-shadow 0.2s ease-in-out;
        }
        .menu-item:hover {
             transform: translateY(-5px);
             box-shadow: 0 6px 15px rgba(0, 0, 0, 0.15);
        }
        .menu-item .icon {
             font-size: 2rem;
             margin-right: 15px;
        }
        .menu-item.green { background-color: #4caf50; }
        .menu-item.blue { background-color: #2196f3; }
        .menu-item.purple { background-color: #9c27b0; }
        .menu-item.yellow { background-color: #ffeb3b; color: #333; }
        .menu-item.grey { background-color: #9e9e9e; }
        .menu-item.red { background-color: #f44336; }
        .back-to-home {
             display: block;
             text-align: center;
             margin-top: 40px;
             padding: 10px 20px;
             border: 1px solid #ccc;
             border-radius: 5px;
             color: #666;
             text-decoration: none;
             transition: background-color 0.2s;
        }
        .back-to-home:hover {
             background-color: #f0f0f0;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>ğŸ§­ ãƒ¬ã‚¸ãƒªã‚¨ãƒ³ã‚¹å‘ä¸Šãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°</h1>
            <p>äººç”Ÿã‚’ã‚ˆã‚Šå……å®Ÿã•ã›ã¦ã„ããŸã‚ã«å¿ƒã®ç­‹ãƒˆãƒ¬ã‚’è¡Œã„ã¾ã—ã‚‡ã†ğŸ¤©</p>
        </header>

        <div class="top-nav-controls" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
            <button id="howToUseButton" class="button-primary" style="background-color: #3498db; border-color: #3498db; font-size: 0.9rem;">
        ä½¿ã„æ–¹
    </button>
    <button id="logoutButton" class="button-primary" style="background-color: #e74c3c; border-color: #e74c3c; font-size: 0.9rem;">
        ãƒ­ã‚°ã‚¢ã‚¦ãƒˆ
    </button>

</div>

<div id="howToUseModal" class="modal">
    <div class="modal-content">
        <span class="close-button">&times;</span>
        <h3>ä½¿ã„æ–¹ </h3>
        <p>ã“ã®ã‚¢ãƒ—ãƒªã§ã¯ã€ä¸»ã«æ€è€ƒå¤‰æ›ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°ã‚’ä½¿ã£ã¦ã€æ—¥å¸¸ç”Ÿæ´»ã§ãƒã‚¬ãƒ†ã‚£ãƒ–ãªå ´é¢ã«é­é‡ã—ãŸéš›ã«æ€è€ƒã‚’ãƒã‚¸ãƒ†ã‚£ãƒ–ã«å¤‰ãˆã¦ã„ããŸã‚ã®ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°ã‚’è¡Œã„ã¾ã™ã€‚</p>
        
        <h4> æ€è€ƒå¤‰æ›ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°</h4>
        <p>ã“ã®æ©Ÿèƒ½ã‚’ç”¨ã„ã¦ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°ã‚’è¡Œã„ã¾ã™ã€‚ã“ã®ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°ã‚’ç¹°ã‚Šè¿”ã™ã“ã¨ã§ã€ãƒã‚¬ãƒ†ã‚£ãƒ–ãªè€ƒãˆæ–¹ã®ã‚¯ã‚»ãŒçŸ¯æ­£ã•ã‚Œã€å¿ƒã®å›å¾©åŠ›ï¼ˆãƒ¬ã‚¸ãƒªã‚¨ãƒ³ã‚¹ï¼‰ãŒé«˜ã¾ã£ã¦ã„ãä»•çµ„ã¿ã§ã™ã€‚</p>
        
        <h4> è¨˜éŒ²ã®æŒ¯ã‚Šè¿”ã‚Š</h4>
        <p>éå»ã«è¡Œã£ãŸãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°è¨˜éŒ²ã‚’ä¸€è¦§ã§ç¢ºèªã—ã€è¨˜éŒ²ã‚’æŒ¯ã‚Šè¿”ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚</p>

        <h4> æˆé•·å¯è¦–åŒ–ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰</h4>
        <p>è¨˜éŒ²ã«å¿œã˜ã¦ã€ã€Œå¹¸ç¦æ‹›ãçŒ«ã€ã®ã‚¹ã‚³ã‚¢ãŒä¸ŠãŒã£ã¦ã„ãã¾ã™ã€‚ã‚¹ã‚³ã‚¢ãŒä¸ŠãŒã‚‹ã®ã¯1æ—¥1å›ã¾ã§ã§ã™ã€‚ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ä¸Šã§è¨˜éŒ²ã‚’ã—ãŸæ—¥ãŒé–²è¦§ã§ãã¾ã™ã€‚æ—¥ã€…ã®æˆé•·ã‚’è¦–è¦šçš„ã«ç¢ºèªã§ãã¾ã™ã€‚</p>


    </div>
</div>

<div id="mypageMenu" style="position: absolute; top: 110px; right: 20px; width: 250px; background: white; border: 1px solid #ddd; border-radius: 8px; box-shadow: 0 4px 10px rgba(0,0,0,0.2); z-index: 20; display: none; text-align: left;">
    <ul style="list-style: none; margin: 0; padding: 10px;">
        <li style="padding: 8px 0; border-bottom: 1px dashed #eee;">
            <strong id="currentUserIdDisplay" style="color: #333;">ID: (ãƒ¦ãƒ¼ã‚¶ãƒ¼ID)</strong>
        </li>
        <li style="padding: 8px 0;">
            <a href="#" id="changeNameLink" style="text-decoration: none; color: #2980b9;">ğŸ“ åå‰ã®å¤‰æ›´ (åŒ¿åãƒ‹ãƒƒã‚¯ãƒãƒ¼ãƒ )</a>
        </li>
        <li style="padding: 8px 0;">
            <a href="view-records-unified.html?filter=my-posts" id="myPostsLink" style="text-decoration: none; color: #2980b9;">ğŸ“ˆ éå»ã®æŠ•ç¨¿/è¨˜éŒ²</a>
        </li>
        <li style="padding: 8px 0;">
            <a href="#" onclick="alert('ã“ã®æ©Ÿèƒ½ã¯ã‚µãƒ¼ãƒãƒ¼é€£æºãŒå¿…è¦ã§ã™ã€‚');" style="text-decoration: none; color: #2980b9;">ğŸ–¼ï¸ ã‚¢ã‚¤ã‚³ãƒ³ã®å¤‰æ›´ (ã‚µãƒ¼ãƒãƒ¼é€£æº)</a>
        </li>
    </ul>
</div>

        <main class="main-content">
            
            <section class="dashboard-section">
    <h2>ğŸ“Š æˆé•·å¯è¦–åŒ–ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰</h2>
    <div class="dashboard-grid">
        

        <div class="dashboard-item-card">
    <h4>ğŸˆ å¹¸ç¦æ‹›ãçŒ«</h4>
    <div id="luckyCatImage" class="lucky-cat-stage stage-0"></div> <span id="luckyCatScore" class="dashboard-value">0pt</span>
    <p style="font-size: 0.8rem; color: #888; margin-top: 5px;">ï¼ˆè“„ç©ã•ã‚ŒãŸå¹¸ç¦åº¦ï¼‰</p>
</div>

        <div class="dashboard-item-card">
        <h4>è¨˜éŒ²ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼</h4>
        
        <div id="calendarNavContainer" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
            </div>
        <div class="calendar-grid" id="recordCalendar">
            </div>
        <p style="font-size: 0.8rem; color: #888; margin-top: 5px;">ï¼ˆè¨˜éŒ²ã‚’è¡Œã£ãŸæ—¥ã‚’è¡¨ç¤ºï¼‰</p>
    </div>
</div>

<div class="dashboard-item-card">
            <h4>æ€è€ƒå¤‰æ›ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°å›æ•°</h4>
            <span id="totalMindRecords" class="dashboard-value">0å›</span>
            <p style="font-size: 0.8rem; color: #888; margin-top: 5px;"></p>
        </div>

</section>

            <nav class="menu">
    <a href="mind-recorder.html" class="menu-item blue" style="padding: 30px; font-size: 1.6rem; font-weight: 700;">
        <span class="icon">ğŸ§ </span>
        æ€è€ƒå¤‰æ›ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°
    </a>

    <a href="view-records-unified.html" class="menu-item dark grey" style="padding: 30px; font-size: 1.6rem; font-weight: 700;">
        <span class="icon">ğŸ“œ</span>
        è¨˜éŒ²ã®æŒ¯ã‚Šè¿”ã‚Š
    </a>
</nav>
        </main>
    </div>

    <script>
    document.addEventListener('DOMContentLoaded', () => {
        // ------------------------------------
        // èªè¨¼ãƒã‚§ãƒƒã‚¯ãƒ­ã‚¸ãƒƒã‚¯
        // ------------------------------------
        const currentUserId = localStorage.getItem('currentUserId');
        
        if (!currentUserId) {
            window.location.href = 'auth.html';
            return;
        }

        // ------------------------------------
        // å…±é€šã®å®šæ•°ã¨ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£
        // ------------------------------------
        const thoughtAssessmentPoints = {
            'bad_to_positive': 4, 'bad_to_negative': -3, 'neutral_to_positive': 3, 'neutral_to_neutral': 0, 
            'neutral_to_negative': -3, 'good_to_more_positive': 1, 'good_to_anxious': -3
        };
        const intensityPoints = { 'low': 0, 'medium': 1, 'high': 2 };
        const catStages = [
            { score: 0, stage: 'stage-0' }, { score: 15, stage: 'stage-1' }, { score: 30, stage: 'stage-2' }, 
            { score: 45, stage: 'stage-3' }, { score: 65, stage: 'stage-4' }, { score: 90, stage: 'stage-5' }, 
            { score: 120, stage: 'stage-6' }, { score: 150, stage: 'stage-7' }
        ];

        const toYMD = (isoString) => new Date(isoString).toISOString().split('T')[0];
        const isConsecutive = (date1, date2) => {
            const d1 = new Date(date1);
            const d2 = new Date(date2);
            const oneDay = 24 * 60 * 60 * 1000;
            const diff = Math.abs(d1.setUTCHours(0, 0, 0, 0) - d2.setUTCHours(0, 0, 0, 0));
            return diff === oneDay;
        };
        
        // ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ã®åˆæœŸè¡¨ç¤ºæœˆã‚’ä¿æŒ
        let currentDisplayDate = new Date(); 

        // ------------------------------------
        // è¨˜éŒ²ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼é–¢æ•° (ç¾çŠ¶ã®æœˆè¡¨ç¤ºã®ã¿)
        // ------------------------------------
        function generateRecordCalendar(allRecords) {
            const recordCalendarElement = document.getElementById('recordCalendar');
            const navContainer = document.getElementById('calendarNavContainer'); 
            
            if (!recordCalendarElement) return; // HTMLæ§‹é€ ã‹ã‚‰ navContainer ã‚’å‰Šé™¤ã—ã¦ã„ã‚‹ãŸã‚ã€navContainerã®ãƒã‚§ãƒƒã‚¯ã¯ä¸è¦

            // ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼æç”»é–‹å§‹
            recordCalendarElement.innerHTML = '';

            const today = new Date();
            const currentMonth = today.getMonth();
            const currentYear = today.getFullYear();

            const recordDates = new Set();
            allRecords.forEach(r => {
                const dateSource = r.date;
                if (dateSource) { 
                    recordDates.add(new Date(dateSource).toDateString());
                }
            });

            // æ›œæ—¥ãƒ˜ãƒƒãƒ€ãƒ¼ã‚’æç”»
            const weekdays = ['æ—¥', 'æœˆ', 'ç«', 'æ°´', 'æœ¨', 'é‡‘', 'åœŸ'];
            weekdays.forEach(day => {
                const header = document.createElement('div');
                header.className = 'calendar-day calendar-header';
                header.textContent = day;
                recordCalendarElement.appendChild(header);
            });

            const firstDayOfMonth = new Date(currentYear, currentMonth, 1);
            const startingDay = firstDayOfMonth.getDay();

            for (let i = 0; i < startingDay; i++) {
                const emptyDay = document.createElement('div');
                emptyDay.className = 'calendar-day';
                recordCalendarElement.appendChild(emptyDay);
            }

            const daysInMonth = new Date(currentYear, currentMonth + 1, 0).getDate();
            for (let i = 1; i <= daysInMonth; i++) {
                const dayElement = document.createElement('div');
                dayElement.className = 'calendar-day';
                dayElement.textContent = i;

                const dateToCheck = new Date(currentYear, currentMonth, i);
                const dateString = dateToCheck.toDateString();
                // UTCã«å½±éŸ¿ã•ã‚Œãªã„ãƒ­ãƒ¼ã‚«ãƒ«YYYY-MM-DDã‚’ç”Ÿæˆ
                const isoDate = `${currentYear}-${String(currentMonth + 1).padStart(2, '0')}-${String(i).padStart(2, '0')}`;
                
                if (dateString === today.toDateString()) {
                    dayElement.classList.add('today');
                }
                
                if (recordDates.has(dateString)) {
                    dayElement.classList.add('has-record');
                    dayElement.classList.add('clickable-date');
                    dayElement.dataset.isoDate = isoDate;
                    dayElement.addEventListener('click', () => {
                        goToRecordsByDate(isoDate);
                    });
                }
                
                if (dateToCheck.getDay() === 0 || dateToCheck.getDay() === 6) { 
                    dayElement.classList.add('weekend');
                }
                
                recordCalendarElement.appendChild(dayElement);
            }
        }
        
        // ------------------------------------
        // ç”»é¢é·ç§»é–¢æ•°
        // ------------------------------------
        function goToRecordsByDate(isoDate) {
            localStorage.setItem('filterDate', isoDate);
            window.location.href = 'view-records-unified.html';
        }

        // ------------------------------------
        // ãƒ¡ã‚¤ãƒ³å‡¦ç† (updateDashboard)
        // ------------------------------------
        function updateDashboard() {
            // â˜…â˜…â˜… getRecords() ãŒã“ã“ã§å‘¼ã°ã‚Œã¾ã™ â˜…â˜…â˜…
            const allUserRecords = getRecords(); 

            const mindRecords = allUserRecords.filter(r => r.type === 'mindRecord');
            const positiveRecords = allUserRecords.filter(r => r.type === 'positive');
            const meditationRecords = allUserRecords.filter(r => r.type === 'meditation');
            
            let totalScore = 0;
            
            // --- 1. ãƒã‚¸ãƒ†ã‚£ãƒ–æ—¥è¨˜ã®ã‚¹ã‚³ã‚¢è¨ˆç®— ---
            const positiveDays = {}; 
            positiveRecords.forEach(r => {
                const dateKey = toYMD(r.date);
                if (!positiveDays[dateKey]) { positiveDays[dateKey] = { base: 0, bonus: 0, intensity: 0, rawRecords: [] }; }
                positiveDays[dateKey].rawRecords.push(r);
            });

            const sortedDates = Object.keys(positiveDays).sort();
            let consecutiveDays = 0;
            let lastDate = null;
            
            for (const dateKey of sortedDates) {
                const records = positiveDays[dateKey];
                records.base = 5;
                
                const maxIntensity = records.rawRecords.reduce((max, r) => 
                    Math.max(max, intensityPoints[r.intensity] || 0), 0);
                records.intensity = maxIntensity; 
                
                if (lastDate && isConsecutive(lastDate, dateKey)) {
                    consecutiveDays++;
                    records.bonus = 2; 
                } else {
                    consecutiveDays = 0;
                }
                lastDate = dateKey;
                
                totalScore += records.base + records.intensity + records.bonus;
            }
            
            // --- 2. ç·ç‘æƒ³æ™‚é–“ã®ã‚¹ã‚³ã‚¢è¨ˆç®— ---
            let totalSeconds = meditationRecords.reduce((sum, r) => sum + (r.duration || 0), 0);
            totalScore += Math.floor(totalSeconds / 120);

            // --- 3. æ€è€ƒå¤‰æ›ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°ã®ã‚¹ã‚³ã‚¢è¨ˆç®— ---
            const mindDays = new Set();
            mindRecords.forEach(r => {
                const dateKey = toYMD(r.date);
                if (mindDays.has(dateKey)) { return; }

                let dayScore = 7;
                const assessmentKey = r.thoughtAssessment;
                const assessmentScore = thoughtAssessmentPoints[assessmentKey] || 0;
                dayScore += assessmentScore;
                
                totalScore += dayScore;
                mindDays.add(dateKey);
            });

            // --- 4. å¹¸ç¦æ‹›ãçŒ«ã®ç”»åƒæ›´æ–° ---
            const luckyCatImageElement = document.getElementById('luckyCatImage');
            document.getElementById('luckyCatScore').textContent = `${totalScore}pt`;
            
            if (luckyCatImageElement) {
                let currentStage = 'stage-0';
                for (let i = catStages.length - 1; i >= 0; i--) {
                    if (totalScore >= catStages[i].score) {
                        currentStage = catStages[i].stage;
                        break;
                    }
                }
                luckyCatImageElement.className = `lucky-cat-stage ${currentStage}`;
            }
            
            // --- 5. ãã®ä»–ã®ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰åæ˜  ---
            const totalMindRecords = mindRecords.length;
            document.getElementById('totalMindRecords').textContent = `${totalMindRecords}å›`;

            /*ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ç”¨ã«æ®‹ã—ã¦ãŠãã‚ˆ

            const uniquePositiveDates = Object.keys(positiveDays);
            document.getElementById('positiveDays').textContent = `${uniquePositiveDates.length}æ—¥`;
            
            const totalMinutes = Math.floor(totalSeconds / 60);
            document.getElementById('totalMeditationTime').textContent = `${totalMinutes}åˆ†`;

            let totalMindsetValue = 0;
            let calmCount = 0;
            const mindsetValueMap = { 'very_calm': 5, 'calm': 4, 'normal': 3, 'restless': 2, 'very_restless': 1 };
            meditationRecords.forEach(r => {
                const value = mindsetValueMap[r.mindset];
                if (value !== undefined) { totalMindsetValue += value; calmCount++; }
            });

            const averageMindsetState = (calmCount > 0) ? (totalMindsetValue / calmCount).toFixed(1) : '--';
            document.getElementById('averageMindsetState').textContent = averageMindsetState;
            */

            // è¨˜éŒ²ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ã®æç”»
            generateRecordCalendar(allUserRecords); 

// ãƒ­ã‚°ã‚¢ã‚¦ãƒˆæ©Ÿèƒ½ã®ãƒ­ã‚¸ãƒƒã‚¯ã®ç›´å¾Œï¼ˆã¾ãŸã¯DOMContentLoadedå†…ã®ã©ã“ã§ã‚‚OKï¼‰ã«è¿½è¨˜

// ------------------------------------
// ä½¿ã„æ–¹ãƒ¢ãƒ¼ãƒ€ãƒ«æ©Ÿèƒ½
// ------------------------------------
const howToUseButton = document.getElementById('howToUseButton');
const howToUseModal = document.getElementById('howToUseModal');
const closeButton = howToUseModal.querySelector('.close-button');

if (howToUseButton && howToUseModal) {
    // ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ãŸã‚‰ãƒ¢ãƒ¼ãƒ€ãƒ«ã‚’è¡¨ç¤º
    howToUseButton.addEventListener('click', () => {
        howToUseModal.style.display = 'block';
    });
    
    // é–‰ã˜ã‚‹ãƒœã‚¿ãƒ³ï¼ˆÃ—ï¼‰ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ãŸã‚‰ãƒ¢ãƒ¼ãƒ€ãƒ«ã‚’éè¡¨ç¤º
    closeButton.addEventListener('click', () => {
        howToUseModal.style.display = 'none';
    });
    
    // ãƒ¢ãƒ¼ãƒ€ãƒ«ã®å¤–å´ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ãŸã‚‰ãƒ¢ãƒ¼ãƒ€ãƒ«ã‚’éè¡¨ç¤º
    window.addEventListener('click', (event) => {
        if (event.target == howToUseModal) {
            howToUseModal.style.display = 'none';
        }
    });
}


        }

        // ------------------------------------
        // ãƒ­ã‚°ã‚¢ã‚¦ãƒˆæ©Ÿèƒ½
        // ------------------------------------
        const logoutButton = document.getElementById('logoutButton');
        if (logoutButton) {
            logoutButton.addEventListener('click', () => {
                if (confirm('ãƒ­ã‚°ã‚¢ã‚¦ãƒˆã—ã¾ã™ã‹ï¼Ÿ')) {
                    localStorage.removeItem('currentUserId');
                    window.location.href = 'auth.html';
                }
            });
        }
        
        // åˆæœŸå®Ÿè¡Œ
        updateDashboard();
    });
</script>
</body>
</html> 